<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Exercise 1: Task 2 in lecture notes | STATS5099 Data Mining and Machine Learning</title>
  <meta name="description" content="2 Exercise 1: Task 2 in lecture notes | STATS5099 Data Mining and Machine Learning" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Exercise 1: Task 2 in lecture notes | STATS5099 Data Mining and Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Exercise 1: Task 2 in lecture notes | STATS5099 Data Mining and Machine Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="exercise-2-german-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to DMML Lab 8</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#implementing-neural-networks-in-r"><i class="fa fa-check"></i><b>1.1</b> Implementing neural networks in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exercise-1-task-2-in-lecture-notes.html"><a href="exercise-1-task-2-in-lecture-notes.html"><i class="fa fa-check"></i><b>2</b> Exercise 1: Task 2 in lecture notes</a></li>
<li class="chapter" data-level="3" data-path="exercise-2-german-data.html"><a href="exercise-2-german-data.html"><i class="fa fa-check"></i><b>3</b> Exercise 2: German data</a></li>
<li class="chapter" data-level="4" data-path="introduction-to-pytorch.html"><a href="introduction-to-pytorch.html"><i class="fa fa-check"></i><b>4</b> Introduction to PyTorch</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-pytorch.html"><a href="introduction-to-pytorch.html#install-pytorch"><i class="fa fa-check"></i><b>4.1</b> Install PyTorch</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-pytorch.html"><a href="introduction-to-pytorch.html#what-is-pytorch"><i class="fa fa-check"></i><b>4.2</b> What is PyTorch?</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-pytorch.html"><a href="introduction-to-pytorch.html#basic-computations-on-tensors"><i class="fa fa-check"></i><b>4.3</b> Basic computations on Tensors</a></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-pytorch.html"><a href="introduction-to-pytorch.html#neural-networks-in-pytorch"><i class="fa fa-check"></i><b>4.4</b> Neural networks in PyTorch</a></li>
<li class="chapter" data-level="4.5" data-path="introduction-to-pytorch.html"><a href="introduction-to-pytorch.html#automatic-differentiation-in-pytorch"><i class="fa fa-check"></i><b>4.5</b> Automatic Differentiation in PyTorch</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercise-3-dividend-data.html"><a href="exercise-3-dividend-data.html"><i class="fa fa-check"></i><b>5</b> Exercise 3: Dividend data</a>
<ul>
<li class="chapter" data-level="" data-path="exercise-3-dividend-data.html"><a href="exercise-3-dividend-data.html#neural-networks-in-r"><i class="fa fa-check"></i>Neural Networks in R</a></li>
<li class="chapter" data-level="" data-path="exercise-3-dividend-data.html"><a href="exercise-3-dividend-data.html#neural-networks-in-pytorch-1"><i class="fa fa-check"></i>Neural Networks in PyTorch</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STATS5099 Data Mining and Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-1-task-2-in-lecture-notes" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Exercise 1: Task 2 in lecture notes<a href="exercise-1-task-2-in-lecture-notes.html#exercise-1-task-2-in-lecture-notes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>QUESTION</strong>: On the <code>Boston</code> data, fit five neural networks such that</p>
<ul>
<li>the input layer has four nodes (<code>crime.rate</code>, <code>low.socio.status</code>, <code>aver.rooms</code> and <code>river.bounds</code>)</li>
<li>the output layer has one node (<code>median.value</code>)</li>
<li>one hidden layer with the logistic function as its activation function and different number of hidden nodes, specifically from 1 up to 5.</li>
</ul>
<p>For each neural network (i.e. the network with the specific number of hidden nodes), estimate the sum of squared errors (SSEs) for the training and test data sets. Visualise the SSEs with a graph and comment on its output.</p>
<p><br></p>
<p>The following codes were included in the lecture note to pre-process the data and split the data into training and test sets.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-1" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb4-2"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb4-3"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-3" tabindex="-1"></a><span class="fu">data</span>(Boston)</span>
<span id="cb4-4"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-4" tabindex="-1"></a>Boston <span class="ot">&lt;-</span> Boston[,<span class="fu">c</span>(<span class="st">&quot;medv&quot;</span>,<span class="st">&quot;crim&quot;</span>,<span class="st">&quot;lstat&quot;</span>,<span class="st">&quot;rm&quot;</span>,<span class="st">&quot;rad&quot;</span>,<span class="st">&quot;chas&quot;</span>)]</span>
<span id="cb4-5"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-5" tabindex="-1"></a><span class="fu">colnames</span>(Boston) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;median.value&quot;</span>,<span class="st">&quot;crime.rate&quot;</span>,<span class="st">&quot;low.socio.status&quot;</span>,</span>
<span id="cb4-6"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-6" tabindex="-1"></a><span class="st">&quot;aver.rooms&quot;</span>,<span class="st">&quot;index.radial.highways&quot;</span>,<span class="st">&quot;river.bounds&quot;</span>)</span>
<span id="cb4-7"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-8" tabindex="-1"></a><span class="co"># min-max normalisation</span></span>
<span id="cb4-9"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-9" tabindex="-1"></a>maxs <span class="ot">&lt;-</span> <span class="fu">apply</span>(Boston, <span class="dv">2</span>, max)</span>
<span id="cb4-10"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-10" tabindex="-1"></a>mins <span class="ot">&lt;-</span> <span class="fu">apply</span>(Boston, <span class="dv">2</span>, min)</span>
<span id="cb4-11"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-11" tabindex="-1"></a>scaled <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(Boston, <span class="at">center =</span> mins, <span class="at">scale =</span> maxs <span class="sc">-</span> mins))</span>
<span id="cb4-12"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-13" tabindex="-1"></a><span class="co"># train-test random splitting</span></span>
<span id="cb4-14"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84</span>)</span>
<span id="cb4-15"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-15" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Boston),<span class="fu">round</span>(<span class="fl">0.75</span><span class="sc">*</span><span class="fu">nrow</span>(Boston)))</span>
<span id="cb4-16"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-16" tabindex="-1"></a>train_Boston<span class="ot">&lt;-</span> scaled[ index,]</span>
<span id="cb4-17"><a href="exercise-1-task-2-in-lecture-notes.html#cb4-17" tabindex="-1"></a>test_Boston <span class="ot">&lt;-</span> scaled[<span class="sc">-</span>index,]</span></code></pre></div>
<p><strong>Hint</strong>:</p>
<ol style="list-style-type: decimal">
<li>Write down the <code>R</code> command to fit a neural network on this dataset.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p>Suppose the hidden layer has only one hidden node. The corresponding <code>R</code> code is as follows.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="exercise-1-task-2-in-lecture-notes.html#cb5-1" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(median.value<span class="sc">~</span>crime.rate<span class="sc">+</span>low.socio.status<span class="sc">+</span>aver.rooms<span class="sc">+</span>river.bounds, </span>
<span id="cb5-2"><a href="exercise-1-task-2-in-lecture-notes.html#cb5-2" tabindex="-1"></a>                   <span class="at">data=</span>train_Boston, <span class="at">hidden=</span><span class="fu">c</span>(<span class="dv">1</span>), <span class="at">linear.output=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Write down the <code>R</code> commands to calculate SSEs for the training and test data sets.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p>Slightly different from the usual formula for sum of squared errors, we divide it by two so that the formula is consistent with the <code>neuralnet</code> package:
<span class="math display">\[\frac{\sum(\text{observed}-\text{fitted values})^2}{2}\]</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="exercise-1-task-2-in-lecture-notes.html#cb6-1" tabindex="-1"></a><span class="co"># training SSEs</span></span>
<span id="cb6-2"><a href="exercise-1-task-2-in-lecture-notes.html#cb6-2" tabindex="-1"></a>train_SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>((Model<span class="sc">$</span>net.result[[<span class="dv">1</span>]]<span class="sc">-</span>train_Boston<span class="sc">$</span>median.value)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb6-3"><a href="exercise-1-task-2-in-lecture-notes.html#cb6-3" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> neuralnet<span class="sc">::</span><span class="fu">compute</span>(Model,test_Boston[,<span class="fu">c</span>(<span class="st">&quot;crime.rate&quot;</span>,</span>
<span id="cb6-4"><a href="exercise-1-task-2-in-lecture-notes.html#cb6-4" tabindex="-1"></a><span class="st">&quot;low.socio.status&quot;</span>,<span class="st">&quot;aver.rooms&quot;</span>)])</span>
<span id="cb6-5"><a href="exercise-1-task-2-in-lecture-notes.html#cb6-5" tabindex="-1"></a>test_SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>((test_pred<span class="sc">$</span>net.result[[<span class="dv">1</span>]]<span class="sc">-</span>test_Boston<span class="sc">$</span>median.value)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Combining the two hints to solve the question.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-1" tabindex="-1"></a><span class="fu">library</span>(neuralnet)</span>
<span id="cb7-2"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84</span>)</span>
<span id="cb7-3"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-4" tabindex="-1"></a><span class="co"># create an empty dataframe to save training and test SSE.</span></span>
<span id="cb7-5"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-5" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb7-6"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-6" tabindex="-1"></a><span class="fu">colnames</span>(SSE) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;no.hidden nodes&quot;</span>,<span class="st">&quot;train SSE&quot;</span>,<span class="st">&quot;test SSE&quot;</span>)</span>
<span id="cb7-7"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-8" tabindex="-1"></a><span class="co"># train the neural network and record training and test SSE</span></span>
<span id="cb7-9"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb7-10"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-10" tabindex="-1"></a>  SSE[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> i <span class="co">#record the number of hidden nodes</span></span>
<span id="cb7-11"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-11" tabindex="-1"></a>  nn_boston <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(median.value<span class="sc">~</span>crime.rate<span class="sc">+</span>low.socio.status<span class="sc">+</span>aver.rooms<span class="sc">+</span>river.bounds,</span>
<span id="cb7-12"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-12" tabindex="-1"></a>                         <span class="at">data=</span>train_Boston, <span class="at">hidden=</span><span class="fu">c</span>(i), <span class="at">linear.output=</span><span class="cn">TRUE</span>) <span class="co">#fit the model</span></span>
<span id="cb7-13"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-13" tabindex="-1"></a>  SSE[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>((nn_boston<span class="sc">$</span>net.result[[<span class="dv">1</span>]] <span class="sc">-</span> train_Boston[,<span class="st">&quot;median.value&quot;</span>])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span> <span class="co">#record training SSE</span></span>
<span id="cb7-14"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-14" tabindex="-1"></a>  test_pred <span class="ot">&lt;-</span> neuralnet<span class="sc">::</span><span class="fu">compute</span>(nn_boston, test_Boston[, <span class="fu">c</span>(<span class="st">&quot;crime.rate&quot;</span>,<span class="st">&quot;low.socio.status&quot;</span>,<span class="st">&quot;aver.rooms&quot;</span>,<span class="st">&quot;river.bounds&quot;</span>)])</span>
<span id="cb7-15"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-15" tabindex="-1"></a>  SSE[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>((test_pred<span class="sc">$</span>net.result[[<span class="dv">1</span>]] <span class="sc">-</span> test_Boston[, <span class="st">&quot;median.value&quot;</span>])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span> <span class="co">#record test SSE</span></span>
<span id="cb7-16"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-16" tabindex="-1"></a>}</span>
<span id="cb7-17"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-17" tabindex="-1"></a></span>
<span id="cb7-18"><a href="exercise-1-task-2-in-lecture-notes.html#cb7-18" tabindex="-1"></a>SSE</span></code></pre></div>
<pre><code>##   no.hidden nodes train SSE test SSE
## 1               1  2.128904 4.342257
## 2               2  1.686398 3.460076
## 3               3  1.488804 3.271197
## 4               4  1.208661 3.345709
## 5               5  1.201828 3.091838</code></pre>
<p>To visualise the SSEs, we create a bar plot using <code>ggplot</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-1" tabindex="-1"></a><span class="co"># Bar plot of results</span></span>
<span id="cb9-2"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2);<span class="fu">library</span>(tibble)</span>
<span id="cb9-3"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-3" tabindex="-1"></a>Regression_NN_Errors <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Network =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;NN1&quot;</span>, <span class="st">&quot;NN2&quot;</span>, <span class="st">&quot;NN3&quot;</span>, <span class="st">&quot;NN4&quot;</span>, <span class="st">&quot;NN5&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb9-4"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-4" tabindex="-1"></a>                               <span class="at">DataSet =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Train&quot;</span>, <span class="st">&quot;Test&quot;</span>), <span class="at">time =</span> <span class="dv">5</span>),</span>
<span id="cb9-5"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-5" tabindex="-1"></a>                               <span class="at">SSE =</span> <span class="fu">c</span>(<span class="fu">t</span>(SSE[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])))</span>
<span id="cb9-6"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-6" tabindex="-1"></a>nn_ggplot <span class="ot">&lt;-</span> Regression_NN_Errors <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Network, SSE, <span class="at">fill =</span> DataSet)) <span class="sc">+</span></span>
<span id="cb9-8"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-8" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-9" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Neural networks SSE (different number of nodes in the hidden layer)&quot;</span>)</span>
<span id="cb9-10"><a href="exercise-1-task-2-in-lecture-notes.html#cb9-10" tabindex="-1"></a>nn_ggplot</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;" />
We can notice that:</p>
<ul>
<li><p>the training SSE is decreasing while the number of hidden nodes increases, and</p></li>
<li><p>the test SSE is not monotonically decreasing and the lowest test SSE is achieved when the network has five nodes in the hidden layer.</p></li>
</ul>
<p>The first finding should not be surprising as adding more hidden nodes increases model capacity and hence the training error will decrease. However, a larger model may suffer from overfitting and hence the test error may not always decreasing. In general, we prefer the "least" complex neural network with the low(est) SSE on the test data set. Note that using different criteria could give us totally different results.</p>
<p>In addition, be cautious that the current result is produced based on a single training of neural network. Since the optimisation of neural network is sensitive to initialisation, running the algorithm again is likely to lead to different conclusions. To alleviate such randomness, consider adding the argument <code>rep</code> into <code>neuralnet</code>; e.g. including <code>rep=10</code> will force the same network to be trained for ten times.</p>
</div>

</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-2-german-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
