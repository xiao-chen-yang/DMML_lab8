<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Exercise 2: German data | STATS5099 Data Mining and Machine Learning</title>
  <meta name="description" content="3 Exercise 2: German data | STATS5099 Data Mining and Machine Learning" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Exercise 2: German data | STATS5099 Data Mining and Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Exercise 2: German data | STATS5099 Data Mining and Machine Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercise-1-task-2-in-lecture-notes.html"/>
<link rel="next" href="exercise-3-dividend-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to DMML Lab 8</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#implementing-neural-networks-in-r"><i class="fa fa-check"></i><b>1.1</b> Implementing neural networks in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exercise-1-task-2-in-lecture-notes.html"><a href="exercise-1-task-2-in-lecture-notes.html"><i class="fa fa-check"></i><b>2</b> Exercise 1: Task 2 in lecture notes</a></li>
<li class="chapter" data-level="3" data-path="exercise-2-german-data.html"><a href="exercise-2-german-data.html"><i class="fa fa-check"></i><b>3</b> Exercise 2: German data</a></li>
<li class="chapter" data-level="4" data-path="exercise-3-dividend-data.html"><a href="exercise-3-dividend-data.html"><i class="fa fa-check"></i><b>4</b> Exercise 3: Dividend data</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STATS5099 Data Mining and Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-2-german-data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Exercise 2: German data<a href="exercise-2-german-data.html#exercise-2-german-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This exercise extends Examples 6-8 in lecture note.</p>
<p><strong>Task</strong></p>
<ol style="list-style-type: decimal">
<li>Fit multiple neural networks with <code>Account_balance</code>, <code>Purpose</code>, <code>Length_of_cur_employment</code> and <code>Credit_Amount</code> as predictors in your model.</li>
</ol>
<div class="webex-solution">
<button>
Hide
</button>
<p>Remember to pre-process the data for both categorical variables and continuous variables before fitting the neural network. The categorical variables should be transformed into dummy variables using one-hot encoding and the continuous variables should be scaled using either standardisation or min-max normalisation.</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Compare the cross-entropy loss, Akaike Information Criterion
(AIC) and Bayesian Information Criterion (BIC) of different models, and select the optimal model.</li>
</ol>
<div class="webex-solution">
<button>
Hide
</button>
<p>To get AIC and BIC, set the argument <code>likelihood=TRUE</code> in <code>neuralnet</code>.</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>For the optimal model you selected in part (2), report its test performance.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="exercise-2-german-data.html#cb10-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;German.RData&quot;</span>)</span>
<span id="cb10-2"><a href="exercise-2-german-data.html#cb10-2" tabindex="-1"></a>train <span class="ot">&lt;-</span> German_train</span>
<span id="cb10-3"><a href="exercise-2-german-data.html#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="exercise-2-german-data.html#cb10-4" tabindex="-1"></a><span class="co"># Data pre-processing</span></span>
<span id="cb10-5"><a href="exercise-2-german-data.html#cb10-5" tabindex="-1"></a>min_max_scale <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb10-6"><a href="exercise-2-german-data.html#cb10-6" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb10-7"><a href="exercise-2-german-data.html#cb10-7" tabindex="-1"></a>}</span>
<span id="cb10-8"><a href="exercise-2-german-data.html#cb10-8" tabindex="-1"></a>train<span class="sc">$</span>Credit_amount <span class="ot">&lt;-</span> <span class="fu">min_max_scale</span>(train<span class="sc">$</span>Credit_amount)</span>
<span id="cb10-9"><a href="exercise-2-german-data.html#cb10-9" tabindex="-1"></a>credit_card_matrix <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>Account_balance<span class="sc">+</span>Purpose<span class="sc">+</span>Length_of_cur_employment</span>
<span id="cb10-10"><a href="exercise-2-german-data.html#cb10-10" tabindex="-1"></a>                                   <span class="sc">+</span>Credit_amount, <span class="at">data=</span>train)</span>
<span id="cb10-11"><a href="exercise-2-german-data.html#cb10-11" tabindex="-1"></a>credit_card_matrix_final <span class="ot">&lt;-</span> credit_card_matrix[,<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Next we fit a few neural networks with different width (i.e. the number of hidden nodes) and depth (i.e. the number of hidden layers).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="exercise-2-german-data.html#cb11-1" tabindex="-1"></a>train<span class="sc">$</span>Creditability <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(train<span class="sc">$</span>Creditability)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-2"><a href="exercise-2-german-data.html#cb11-2" tabindex="-1"></a>predictor_list <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">colnames</span>(credit_card_matrix_final),<span class="at">collapse=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb11-3"><a href="exercise-2-german-data.html#cb11-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">&quot;train$Creditability~&quot;</span>,predictor_list),<span class="at">collapse=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb11-4"><a href="exercise-2-german-data.html#cb11-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84</span>)</span>
<span id="cb11-5"><a href="exercise-2-german-data.html#cb11-5" tabindex="-1"></a>nn_credit_one_layer <span class="ot">&lt;-</span>  <span class="fu">neuralnet</span>(f,<span class="at">data=</span>credit_card_matrix_final,<span class="at">hidden=</span><span class="fu">c</span>(<span class="dv">5</span>),</span>
<span id="cb11-6"><a href="exercise-2-german-data.html#cb11-6" tabindex="-1"></a>                               <span class="at">linear.output =</span> <span class="cn">FALSE</span>,<span class="at">err.fct =</span> <span class="st">&#39;ce&#39;</span>,</span>
<span id="cb11-7"><a href="exercise-2-german-data.html#cb11-7" tabindex="-1"></a>                               <span class="at">likelihood=</span><span class="cn">TRUE</span>, <span class="at">threshold =</span> <span class="fl">0.1</span>)</span>
<span id="cb11-8"><a href="exercise-2-german-data.html#cb11-8" tabindex="-1"></a>nn_credit_two_layers_1 <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(f,<span class="at">data=</span>credit_card_matrix_final,</span>
<span id="cb11-9"><a href="exercise-2-german-data.html#cb11-9" tabindex="-1"></a>                                            <span class="at">hidden=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>),</span>
<span id="cb11-10"><a href="exercise-2-german-data.html#cb11-10" tabindex="-1"></a>                               <span class="at">linear.output =</span> <span class="cn">FALSE</span>,<span class="at">err.fct =</span> <span class="st">&#39;ce&#39;</span>,</span>
<span id="cb11-11"><a href="exercise-2-german-data.html#cb11-11" tabindex="-1"></a>                               <span class="at">likelihood=</span><span class="cn">TRUE</span>, <span class="at">threshold =</span> <span class="fl">0.1</span>)</span>
<span id="cb11-12"><a href="exercise-2-german-data.html#cb11-12" tabindex="-1"></a>nn_credit_two_layers_2 <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(f,<span class="at">data=</span>credit_card_matrix_final,</span>
<span id="cb11-13"><a href="exercise-2-german-data.html#cb11-13" tabindex="-1"></a>                                            <span class="at">hidden=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb11-14"><a href="exercise-2-german-data.html#cb11-14" tabindex="-1"></a>                               <span class="at">linear.output =</span> <span class="cn">FALSE</span>,<span class="at">err.fct =</span> <span class="st">&#39;ce&#39;</span>,</span>
<span id="cb11-15"><a href="exercise-2-german-data.html#cb11-15" tabindex="-1"></a>                               <span class="at">likelihood=</span><span class="cn">TRUE</span>, <span class="at">threshold =</span> <span class="fl">0.1</span>)</span>
<span id="cb11-16"><a href="exercise-2-german-data.html#cb11-16" tabindex="-1"></a>nn_credit_two_layers_3 <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(f,<span class="at">data=</span>credit_card_matrix_final,</span>
<span id="cb11-17"><a href="exercise-2-german-data.html#cb11-17" tabindex="-1"></a>                                            <span class="at">hidden=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>),</span>
<span id="cb11-18"><a href="exercise-2-german-data.html#cb11-18" tabindex="-1"></a>                               <span class="at">linear.output =</span> <span class="cn">FALSE</span>,<span class="at">err.fct =</span> <span class="st">&#39;ce&#39;</span>,</span>
<span id="cb11-19"><a href="exercise-2-german-data.html#cb11-19" tabindex="-1"></a>                               <span class="at">likelihood=</span><span class="cn">TRUE</span>, <span class="at">threshold =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p>Now we produce a bar plot comparing all built models.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="exercise-2-german-data.html#cb12-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2); <span class="fu">library</span>(dplyr)</span>
<span id="cb12-2"><a href="exercise-2-german-data.html#cb12-2" tabindex="-1"></a>Class_NN_ICs <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&#39;Network&#39;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;NN_1L&quot;</span>,<span class="st">&quot;NN_2L_1&quot;</span>, <span class="st">&quot;NN_2L_2&quot;</span>,</span>
<span id="cb12-3"><a href="exercise-2-german-data.html#cb12-3" tabindex="-1"></a>                                         <span class="st">&quot;NN_2L_3&quot;</span>), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb12-4"><a href="exercise-2-german-data.html#cb12-4" tabindex="-1"></a>                       <span class="st">&#39;Metric&#39;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;AIC&#39;</span>, <span class="st">&#39;BIC&#39;</span>,<span class="st">&#39;CE loss&#39;</span>), <span class="at">length.out=</span><span class="dv">12</span>),</span>
<span id="cb12-5"><a href="exercise-2-german-data.html#cb12-5" tabindex="-1"></a>                       <span class="st">&#39;Value&#39;</span> <span class="ot">=</span> <span class="fu">c</span>(nn_credit_one_layer<span class="sc">$</span>result.matrix[<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb12-6"><a href="exercise-2-german-data.html#cb12-6" tabindex="-1"></a>                                  nn_credit_one_layer<span class="sc">$</span>result.matrix[<span class="dv">5</span>,<span class="dv">1</span>],</span>
<span id="cb12-7"><a href="exercise-2-german-data.html#cb12-7" tabindex="-1"></a>                                  nn_credit_one_layer<span class="sc">$</span>result.matrix[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb12-8"><a href="exercise-2-german-data.html#cb12-8" tabindex="-1"></a>                                  nn_credit_two_layers_1<span class="sc">$</span>result.matrix[<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb12-9"><a href="exercise-2-german-data.html#cb12-9" tabindex="-1"></a>                                  nn_credit_two_layers_1<span class="sc">$</span>result.matrix[<span class="dv">5</span>,<span class="dv">1</span>],</span>
<span id="cb12-10"><a href="exercise-2-german-data.html#cb12-10" tabindex="-1"></a>                                  nn_credit_two_layers_1<span class="sc">$</span>result.matrix[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb12-11"><a href="exercise-2-german-data.html#cb12-11" tabindex="-1"></a>                                  nn_credit_two_layers_2<span class="sc">$</span>result.matrix[<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb12-12"><a href="exercise-2-german-data.html#cb12-12" tabindex="-1"></a>                                  nn_credit_two_layers_2<span class="sc">$</span>result.matrix[<span class="dv">5</span>,<span class="dv">1</span>],</span>
<span id="cb12-13"><a href="exercise-2-german-data.html#cb12-13" tabindex="-1"></a>                                  nn_credit_two_layers_2<span class="sc">$</span>result.matrix[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb12-14"><a href="exercise-2-german-data.html#cb12-14" tabindex="-1"></a>                                  nn_credit_two_layers_3<span class="sc">$</span>result.matrix[<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb12-15"><a href="exercise-2-german-data.html#cb12-15" tabindex="-1"></a>                                  nn_credit_two_layers_3<span class="sc">$</span>result.matrix[<span class="dv">5</span>,<span class="dv">1</span>],</span>
<span id="cb12-16"><a href="exercise-2-german-data.html#cb12-16" tabindex="-1"></a>                                  nn_credit_two_layers_3<span class="sc">$</span>result.matrix[<span class="dv">1</span>,<span class="dv">1</span>]))</span>
<span id="cb12-17"><a href="exercise-2-german-data.html#cb12-17" tabindex="-1"></a>nn_ggplot <span class="ot">&lt;-</span> Class_NN_ICs <span class="sc">%&gt;%</span></span>
<span id="cb12-18"><a href="exercise-2-german-data.html#cb12-18" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Network, Value, <span class="at">fill=</span>Metric)) <span class="sc">+</span></span>
<span id="cb12-19"><a href="exercise-2-german-data.html#cb12-19" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)  <span class="sc">+</span></span>
<span id="cb12-20"><a href="exercise-2-german-data.html#cb12-20" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;AIC, BIC, and cross entropy loss of the neural networks&quot;</span>)</span>
<span id="cb12-21"><a href="exercise-2-german-data.html#cb12-21" tabindex="-1"></a>nn_ggplot</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>First recall that a smaller value of AIC and BIC indicates a better model.</p>
<p>In terms of AIC the fourth neural network with 2 hidden layer and 5 and 3 nodes in each layer seemed to be best, while BIC preferred the second neural network with 2 hidden layers and 4 and 1 nodes in each layer. The cross entropy loss agreed with AIC so we would probably choose the fourth neural network. This is an example of one of the many times where information criteria give different answer since they penalise complexity in different ways.</p>
<p>We can also double check the previous comments, and find out which neural network is the one with the smallest value for the cross-entropy loss function, by using the <code>which.min</code> command.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exercise-2-german-data.html#cb13-1" tabindex="-1"></a><span class="fu">which.min</span>(<span class="fu">c</span>(nn_credit_one_layer<span class="sc">$</span>result.matrix[<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb13-2"><a href="exercise-2-german-data.html#cb13-2" tabindex="-1"></a>            nn_credit_two_layers_1<span class="sc">$</span>result.matrix[<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb13-3"><a href="exercise-2-german-data.html#cb13-3" tabindex="-1"></a>            nn_credit_two_layers_2<span class="sc">$</span>result.matrix[<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb13-4"><a href="exercise-2-german-data.html#cb13-4" tabindex="-1"></a>            nn_credit_two_layers_3<span class="sc">$</span>result.matrix[<span class="dv">4</span>,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## aic 
##   4</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="exercise-2-german-data.html#cb15-1" tabindex="-1"></a><span class="fu">which.min</span>(<span class="fu">c</span>(nn_credit_one_layer<span class="sc">$</span>result.matrix[<span class="dv">5</span>,<span class="dv">1</span>],</span>
<span id="cb15-2"><a href="exercise-2-german-data.html#cb15-2" tabindex="-1"></a>            nn_credit_two_layers_1<span class="sc">$</span>result.matrix[<span class="dv">5</span>,<span class="dv">1</span>],</span>
<span id="cb15-3"><a href="exercise-2-german-data.html#cb15-3" tabindex="-1"></a>            nn_credit_two_layers_2<span class="sc">$</span>result.matrix[<span class="dv">5</span>,<span class="dv">1</span>],</span>
<span id="cb15-4"><a href="exercise-2-german-data.html#cb15-4" tabindex="-1"></a>            nn_credit_two_layers_3<span class="sc">$</span>result.matrix[<span class="dv">5</span>,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## bic 
##   3</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="exercise-2-german-data.html#cb17-1" tabindex="-1"></a><span class="fu">which.min</span>(<span class="fu">c</span>(nn_credit_one_layer<span class="sc">$</span>result.matrix[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb17-2"><a href="exercise-2-german-data.html#cb17-2" tabindex="-1"></a>            nn_credit_two_layers_1<span class="sc">$</span>result.matrix[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb17-3"><a href="exercise-2-german-data.html#cb17-3" tabindex="-1"></a>            nn_credit_two_layers_2<span class="sc">$</span>result.matrix[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb17-4"><a href="exercise-2-german-data.html#cb17-4" tabindex="-1"></a>            nn_credit_two_layers_3<span class="sc">$</span>result.matrix[<span class="dv">1</span>,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## error 
##     4</code></pre>
<p>To predict on the test data, we need to first clean the data as for the training data.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="exercise-2-german-data.html#cb19-1" tabindex="-1"></a><span class="co"># Data pre-processing</span></span>
<span id="cb19-2"><a href="exercise-2-german-data.html#cb19-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> German_test</span>
<span id="cb19-3"><a href="exercise-2-german-data.html#cb19-3" tabindex="-1"></a>test<span class="sc">$</span>Credit_amount <span class="ot">&lt;-</span> <span class="fu">min_max_scale</span>(test<span class="sc">$</span>Credit_amount)</span>
<span id="cb19-4"><a href="exercise-2-german-data.html#cb19-4" tabindex="-1"></a>test<span class="sc">$</span>Creditability <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(test<span class="sc">$</span>Creditability)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb19-5"><a href="exercise-2-german-data.html#cb19-5" tabindex="-1"></a>test_credit_card_matrix <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>Account_balance<span class="sc">+</span>Purpose<span class="sc">+</span>Length_of_cur_employment</span>
<span id="cb19-6"><a href="exercise-2-german-data.html#cb19-6" tabindex="-1"></a>                                   <span class="sc">+</span>Credit_amount, <span class="at">data=</span>test)</span>
<span id="cb19-7"><a href="exercise-2-german-data.html#cb19-7" tabindex="-1"></a>test_credit_card_matrix_final <span class="ot">&lt;-</span> test_credit_card_matrix[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb19-8"><a href="exercise-2-german-data.html#cb19-8" tabindex="-1"></a></span>
<span id="cb19-9"><a href="exercise-2-german-data.html#cb19-9" tabindex="-1"></a><span class="co"># Prediction</span></span>
<span id="cb19-10"><a href="exercise-2-german-data.html#cb19-10" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn_credit_two_layers_3,test_credit_card_matrix_final)</span>
<span id="cb19-11"><a href="exercise-2-german-data.html#cb19-11" tabindex="-1"></a><span class="fu">table</span>(test<span class="sc">$</span>Creditability,test_pred<span class="sc">&gt;</span><span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   0    60   97
##   1    78  265</code></pre>
</div>

</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-1-task-2-in-lecture-notes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-3-dividend-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
