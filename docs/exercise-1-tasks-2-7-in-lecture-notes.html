<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Exercise 1: Tasks 2-7 in lecture notes | STATS5099 Data Mining and Machine Learning</title>
  <meta name="description" content="2 Exercise 1: Tasks 2-7 in lecture notes | STATS5099 Data Mining and Machine Learning" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Exercise 1: Tasks 2-7 in lecture notes | STATS5099 Data Mining and Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Exercise 1: Tasks 2-7 in lecture notes | STATS5099 Data Mining and Machine Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to DMML Lab 8</a></li>
<li class="chapter" data-level="2" data-path="exercise-1-tasks-2-7-in-lecture-notes.html"><a href="exercise-1-tasks-2-7-in-lecture-notes.html"><i class="fa fa-check"></i><b>2</b> Exercise 1: Tasks 2-7 in lecture notes</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STATS5099 Data Mining and Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-1-tasks-2-7-in-lecture-notes" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Exercise 1: Tasks 2-7 in lecture notes<a href="exercise-1-tasks-2-7-in-lecture-notes.html#exercise-1-tasks-2-7-in-lecture-notes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In Example 3 of Week 8 lecture note, we have performed HAC on <code>USArrests</code> data using the following commands.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb6-1" aria-hidden="true" tabindex="-1"></a>USArrests <span class="ot">&lt;-</span> <span class="fu">scale</span>(USArrests)</span>
<span id="cb6-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb6-2" aria-hidden="true" tabindex="-1"></a>usarrests.clus <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(USArrests)) </span>
<span id="cb6-3"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.dendrogram</span>(usarrests.clus,<span class="at">hang =</span> <span class="dv">0</span>),<span class="at">ylab=</span><span class="st">&quot;complete linkage&quot;</span>,</span>
<span id="cb6-4"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb6-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Euclidean distance&quot;</span>,<span class="at">horiz=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:USdend"></span>
<img src="main_files/figure-html/USdend-1.png" alt="Dendrogram resulting from HAC on USArrests dataset" width="1296" />
<p class="caption">
Figure 2.1: Dendrogram resulting from HAC on USArrests dataset
</p>
</div>
<p>Note that in the above <code>R</code> code, we start by scaling/standardising the data using the function <code>scale</code>. This is important as we don’t want the clustering algorithm to depend to an arbitrary variable unit.</p>
<p>Reading the dendrogram from the right to the left, we see that New Hampshire and Iowa seem to be the first two leaves that constitute a clade. Therefore, we can conclude that New Hampshire and Iowa are most similar to each other.
<br></p>
<p><strong>TASK 3</strong>: Instead of reading from the dendrogram, can you find a way to check that New Hampshire and Iowa are the first two leaves that constitute a clade? Hint: Have a look at <code>usarrests.clus$merge</code> and <code>?hclust</code>.</p>
<div class="webex-solution">
<button>
Solution
</button>
<p>The <code>merge</code> component of the <code>hclust</code> fitted object gives us an <span class="math inline">\(n-1\)</span> by 2 matrix. Let's have a look at it:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(usarrests.clus<span class="sc">$</span>merge)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  -15  -29
## [2,]  -13  -32
## [3,]  -14  -16
## [4,]  -23  -49
## [5,]  -36    3
## [6,]  -20  -31</code></pre>
<p>Row <span class="math inline">\(i\)</span> of <code>merge</code> describes the merging of clusters at step <span class="math inline">\(i\)</span> of the clustering. If an element <span class="math inline">\(j\)</span> in the row is negative, then observation <span class="math inline">\(j\)</span> was merged at this stage. If <span class="math inline">\(j\)</span> is positive then the merge was with the cluster formed at the (earlier) stage <span class="math inline">\(j\)</span> of the algorithm. Thus negative entries in <code>merge</code> indicate agglomerations of observations (i.e. singleton clusters), and positive entries indicate agglomerations of non-singletons clusters.</p>
<p>Looking at the first row, we can see that the <span class="math inline">\(15\)</span>th and <span class="math inline">\(29\)</span>th observations were merged together. These are Iowa and New Hampshire respectively.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(USArrests)[<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">29</span>)]</span></code></pre></div>
<pre><code>## [1] &quot;Iowa&quot;          &quot;New Hampshire&quot;</code></pre>
<p>Note that the 5th row of the merge matrix has a positive number 3 in it. This means that observation 36 (indicated by a -36) is joined to the cluster created in row 3, i.e. observations 14 and 16. So the row creates a cluster of three observations: 36, 14 and 16.</p>
</div>
<p><br></p>
<p><strong>TASK 2</strong>: Let’s say that we now want to focus on the cluster containing the states New Hampshire, Iowa and Maine. Which cluster is the most similar to that one?</p>
<div class="webex-solution">
<button>
Solution
</button>
<p>It's the cluster containing Nebraska, Montana and Idaho. It would be wrong if your answer was the singleton state of Idaho. Because that (singleton) cluster is first merged together with the cluster of Nebraska and Montana, and the new cluster (comprised of Nebraska, Montana and Idaho) is merged together with the cluster of New Hampshire, Iowa and Maine.</p>
</div>
<p>In Example 4, we allocate the observations to three clusters by using <code>cutree</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend)</span>
<span id="cb11-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb11-2" aria-hidden="true" tabindex="-1"></a>dend_usarrests <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(usarrests.clus,<span class="at">hang=</span><span class="dv">0</span>)</span>
<span id="cb11-3"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb11-3" aria-hidden="true" tabindex="-1"></a>allocations <span class="ot">&lt;-</span> <span class="fu">cutree</span>(dend_usarrests,<span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb11-4"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(allocations)</span></code></pre></div>
<pre><code>##    Alabama     Alaska    Arizona   Arkansas California   Colorado 
##          1          1          2          3          2          2</code></pre>
<p><strong>TASK 4</strong>: How could we get the names for the members of the third cluster?</p>
<div class="webex-solution">
<button>
Hint
</button>
<p>Names of US states are given as row names of the dataset, which can be found by using <code>row.names(data)</code>. Observations that belong to the third cluster can be found by using the condition <code>[allocation==3]</code>.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<p>One way to do it is the following:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(USArrests)[allocations<span class="sc">==</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##  [1] &quot;Arkansas&quot;      &quot;Connecticut&quot;   &quot;Delaware&quot;      &quot;Hawaii&quot;       
##  [5] &quot;Idaho&quot;         &quot;Indiana&quot;       &quot;Iowa&quot;          &quot;Kansas&quot;       
##  [9] &quot;Kentucky&quot;      &quot;Maine&quot;         &quot;Massachusetts&quot; &quot;Minnesota&quot;    
## [13] &quot;Missouri&quot;      &quot;Montana&quot;       &quot;Nebraska&quot;      &quot;New Hampshire&quot;
## [17] &quot;New Jersey&quot;    &quot;North Dakota&quot;  &quot;Ohio&quot;          &quot;Oklahoma&quot;     
## [21] &quot;Oregon&quot;        &quot;Pennsylvania&quot;  &quot;Rhode Island&quot;  &quot;South Dakota&quot; 
## [25] &quot;Utah&quot;          &quot;Vermont&quot;       &quot;Virginia&quot;      &quot;Washington&quot;   
## [29] &quot;West Virginia&quot; &quot;Wisconsin&quot;     &quot;Wyoming&quot;</code></pre>
</div>
<p><br></p>
<p><strong>TASK 5</strong>: Based on Figure <a href="exercise-1-tasks-2-7-in-lecture-notes.html#fig:USdend">2.1</a>, determine how many clusters you would obtain if you cut the dendrogram at the heights 2.9 and 2.</p>
<ul>
<li>If the dendrogram is cut at height 2.9, <input class='webex-solveme nospaces' size='1' data-answer='["6"]'/> clusters will be obtained.</li>
<li>If the dendrogram is cut at height 2, <input class='webex-solveme nospaces' size='2' data-answer='["11"]'/> clusters will be obtained.</li>
</ul>
<div class="webex-solution">
<button>
Solution
</button>
<p>In the first case (i.e. cutting the tree at 2.9) we would end up with 6 clusters while in the second case (i.e. cutting the tree at 2) we would end up with 11 clusters. This is a result of Alaska being a singleton cluster that is merged after those heights. It can be verified in <code>R</code> either quantitatively or visually by using the commands below.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend)</span>
<span id="cb15-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb15-2" aria-hidden="true" tabindex="-1"></a>usarrests.clus <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(USArrests))</span>
<span id="cb15-3"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb15-3" aria-hidden="true" tabindex="-1"></a>dend_usarrests <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(usarrests.clus)</span>
<span id="cb15-4"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">cutree</span>(dend_usarrests,<span class="at">h=</span><span class="dv">2</span>))</span>
<span id="cb15-5"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb15-5" aria-hidden="true" tabindex="-1"></a>dendrogram_cut_2height <span class="ot">&lt;-</span> <span class="fu">color_branches</span>(dend_usarrests,<span class="at">h=</span><span class="dv">2</span>)</span>
<span id="cb15-6"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dendrogram_cut_2height,<span class="at">ylab=</span><span class="st">&quot;complete linkage&quot;</span>,</span>
<span id="cb15-7"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb15-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Euclidean distance&quot;</span>,<span class="at">horiz=</span><span class="cn">TRUE</span>)</span>
<span id="cb15-8"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<p><br></p>
<p><strong>TASK 7</strong>: Assume that you have information that Florida and Illinois should be clustered together and at the same time that Florida and Colorado should be in different clusters. What can you do to make this happen?</p>
<div class="webex-solution">
<button>
Solution
</button>
<p>Looking at the dendrogram, you would have to cut the tree before the height where Florida and Colorado merge (e.g. <span class="math inline">\(2.3\)</span>) and after the height where Florida and Illinois merge (e.g. <span class="math inline">\(1.8\)</span>).</p>
</div>
<p><br></p>
<p>The previous tasks all focus on the HAC result using complete linkage as the linkage criterion. Let's now consider other linkage criterion and see it changes the clustering.</p>
<p><strong>TASK 6</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Perform HAC using the following three linkage criteria - single, average, and centroid.</li>
<li>Produce the dendrograms and comment on the plots.</li>
<li>Use the <code>cuttree</code> command to split the observations into 4 clusters. Plot the results using the <code>pairs</code> function and comment on them.</li>
</ol>
<div class="webex-solution">
<button>
Hide
</button>
<ol style="list-style-type: lower-alpha">
<li>The linkage criterion is defined by the <code>method</code> argument within the <code>hclust</code> function.</li>
<li>Look at Example 6.</li>
</ol>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb16-1" aria-hidden="true" tabindex="-1"></a>usarrests.clus.single <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(USArrests),<span class="at">method =</span> <span class="st">&quot;single&quot;</span>)</span>
<span id="cb16-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb16-2" aria-hidden="true" tabindex="-1"></a>usarrests.clus.average <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(USArrests),<span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb16-3"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb16-3" aria-hidden="true" tabindex="-1"></a>usarrests.clus.centroid <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(USArrests),<span class="at">method =</span> <span class="st">&quot;centroid&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>For completeness, the dendrogram of HAC with complete linkage is also plotted.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.dendrogram</span>(usarrests.clus,<span class="at">hang =</span> <span class="dv">0</span>),<span class="at">ylab=</span><span class="st">&quot;complete linkage&quot;</span>,</span>
<span id="cb17-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb17-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Euclidean distance&quot;</span>,<span class="at">horiz=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-15-1.png" width="1296" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.dendrogram</span>(usarrests.clus.single,<span class="at">hang =</span> <span class="dv">0</span>),<span class="at">ylab=</span><span class="st">&quot;single linkage&quot;</span>,</span>
<span id="cb18-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb18-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Euclidean distance&quot;</span>,<span class="at">horiz=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-15-2.png" width="1296" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.dendrogram</span>(usarrests.clus.average,<span class="at">hang =</span> <span class="dv">0</span>),<span class="at">ylab=</span><span class="st">&quot;average linkage&quot;</span>,</span>
<span id="cb19-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb19-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Euclidean distance&quot;</span>,<span class="at">horiz=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-15-3.png" width="1296" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.dendrogram</span>(usarrests.clus.centroid,<span class="at">hang =</span> <span class="dv">0</span>),<span class="at">ylab=</span><span class="st">&quot;centroid linkage&quot;</span>,</span>
<span id="cb20-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb20-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Euclidean distance&quot;</span>,<span class="at">horiz=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-15-4.png" width="1296" />
Comparing the dendrograms produced from HAC with complete linkage and single linkage, it is clear that single linkage shows the chaining pattern, where clusters were merged together due to single elements being close to each other. The average linkage balances out between complete linkage and single linkage. The centroid linkage shows the issue of inversion, e.g. between Delaware and Arkansas.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb21-1" aria-hidden="true" tabindex="-1"></a>four.clus.complete <span class="ot">&lt;-</span> <span class="fu">cutree</span>(usarrests.clus,<span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb21-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(USArrests,<span class="at">col=</span>four.clus.complete,<span class="at">lower.panel=</span><span class="cn">NULL</span>,<span class="at">main=</span><span class="st">&quot;HAC with complete linkage&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb22-1" aria-hidden="true" tabindex="-1"></a>four.clus.single <span class="ot">&lt;-</span> <span class="fu">cutree</span>(usarrests.clus.single,<span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb22-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(USArrests,<span class="at">col=</span>four.clus.single,<span class="at">lower.panel=</span><span class="cn">NULL</span>,<span class="at">main=</span><span class="st">&quot;HAC with single linkage&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb23-1" aria-hidden="true" tabindex="-1"></a>four.clus.average <span class="ot">&lt;-</span> <span class="fu">cutree</span>(usarrests.clus.average,<span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb23-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(USArrests,<span class="at">col=</span>four.clus.average,<span class="at">lower.panel=</span><span class="cn">NULL</span>,<span class="at">main=</span><span class="st">&quot;HAC with average linkage&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-16-3.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb24-1" aria-hidden="true" tabindex="-1"></a>four.clus.centroid <span class="ot">&lt;-</span> <span class="fu">cutree</span>(usarrests.clus.centroid,<span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb24-2"><a href="exercise-1-tasks-2-7-in-lecture-notes.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(USArrests,<span class="at">col=</span>four.clus.centroid,<span class="at">lower.panel=</span><span class="cn">NULL</span>,<span class="at">main=</span><span class="st">&quot;HAC with centroid linkage&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-16-4.png" width="672" /></p>
<p>There is a clear pattern that HAC with single linkage clusters almost all observations into one group, compared with cluster linkage leads to roughly equal number of observations in each cluster. Centroid linkage also results in the vast majority of observations in a single cluster.</p>
</div>
<p><br></p>
<p>While different linkage criteria lead to different clustering results as shown in the pairs plot, without any prior knowledge about the ground truth label of the observation, we cannot conclude which one is better. All we could do is to comment on the clustering performance, e.g. based on the silhouette width.</p>
<p><strong>QUESTION</strong>: Select the optimal number of clusters for HAC with complete, single, average and centroid linkage according to the average silhouette width. After that, suggest which HAC result produces the best clustering for this dataset and comment on the performance.</p>

</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
